<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>tinydtls: dtls_handler_t Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">tinydtls
   &#160;<span id="projectnumber">0.8.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">dtls_handler_t Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="dtls_8h_source.html">dtls.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a1584dc27fdeff72bbea07a8d646f087d"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdtls__handler__t.html#a1584dc27fdeff72bbea07a8d646f087d">write</a> )(struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, <a class="el" href="structsession__t.html">session_t</a> *session, <a class="el" href="global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf, size_t len)</td></tr>
<tr class="separator:a1584dc27fdeff72bbea07a8d646f087d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abafcef01c1edb023b160a5c88bf4c58f"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdtls__handler__t.html#abafcef01c1edb023b160a5c88bf4c58f">read</a> )(struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, <a class="el" href="structsession__t.html">session_t</a> *session, <a class="el" href="global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf, size_t len)</td></tr>
<tr class="separator:abafcef01c1edb023b160a5c88bf4c58f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac976e7d4db8e886f820950940ced755c"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdtls__handler__t.html#ac976e7d4db8e886f820950940ced755c">event</a> )(struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, <a class="el" href="structsession__t.html">session_t</a> *session, <a class="el" href="alert_8h.html#ab6264d1b950719f1c2e00b122cad871f">dtls_alert_level_t</a> level, unsigned short code)</td></tr>
<tr class="separator:ac976e7d4db8e886f820950940ced755c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae645f85dd55a51ca1b3fb554d1e752f6"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdtls__handler__t.html#ae645f85dd55a51ca1b3fb554d1e752f6">get_psk_info</a> )(struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, const <a class="el" href="structsession__t.html">session_t</a> *session, <a class="el" href="dtls_8h.html#a36eda3add5e2d12a3b5e2b6fe7038e01">dtls_credentials_type_t</a> type, const unsigned char *desc, size_t desc_len, unsigned char *result, size_t result_length)</td></tr>
<tr class="separator:ae645f85dd55a51ca1b3fb554d1e752f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e6f70b61d6677d4403668549f3e2c3e"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdtls__handler__t.html#a7e6f70b61d6677d4403668549f3e2c3e">get_ecdsa_key</a> )(struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, const <a class="el" href="structsession__t.html">session_t</a> *session, const <a class="el" href="structdtls__ecdsa__key__t.html">dtls_ecdsa_key_t</a> **result)</td></tr>
<tr class="separator:a7e6f70b61d6677d4403668549f3e2c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80c44baf0a59be0fd842358e651deaf4"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdtls__handler__t.html#a80c44baf0a59be0fd842358e651deaf4">verify_ecdsa_key</a> )(struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, const <a class="el" href="structsession__t.html">session_t</a> *session, const unsigned char *other_pub_x, const unsigned char *other_pub_y, size_t key_size)</td></tr>
<tr class="separator:a80c44baf0a59be0fd842358e651deaf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This structure contains callback functions used by tinydtls to communicate with the application. At least the write function must be provided. It is called by the DTLS state machine to send packets over the network. The read function is invoked to deliver decrypted and verfified application data. The third callback is an event handler function that is called when alert messages are encountered or events generated by the library have occured. </p>

<p>Definition at line <a class="el" href="dtls_8h_source.html#l00084">84</a> of file <a class="el" href="dtls_8h_source.html">dtls.h</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a class="anchor" id="ac976e7d4db8e886f820950940ced755c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* dtls_handler_t::event) (struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, <a class="el" href="structsession__t.html">session_t</a> *session, <a class="el" href="alert_8h.html#ab6264d1b950719f1c2e00b122cad871f">dtls_alert_level_t</a> level, unsigned short code)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The event handler is called when a message from the alert protocol is received or the state of the DTLS session changes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The current dtls context. </td></tr>
    <tr><td class="paramname">session</td><td>The session object that was affected. </td></tr>
    <tr><td class="paramname">level</td><td>The alert level or <code>0</code> when an event ocurred that is not an alert. </td></tr>
    <tr><td class="paramname">code</td><td>Values less than <code>256</code> indicate alerts, while <code>256</code> or greater indicate internal DTLS session changes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ignored </dd></dl>

<p>Definition at line <a class="el" href="dtls_8h_source.html#l00129">129</a> of file <a class="el" href="dtls_8h_source.html">dtls.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7e6f70b61d6677d4403668549f3e2c3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* dtls_handler_t::get_ecdsa_key) (struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, const <a class="el" href="structsession__t.html">session_t</a> *session, const <a class="el" href="structdtls__ecdsa__key__t.html">dtls_ecdsa_key_t</a> **result)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called during handshake to get the server's or client's ecdsa key used to authenticate this server or client in this session. If found, the key must be stored in <code>result</code> and the return value must be <code>0</code>. If not found, <code>result</code> is undefined and the return value must be less than zero.</p>
<p>If ECDSA should not be supported, set this pointer to NULL.</p>
<p>Implement this if you want to provide your own certificate to the other peer. This is mandatory for a server providing ECDSA support and optional for a client. A client doing DTLS client authentication has to implementing this callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The current dtls context. </td></tr>
    <tr><td class="paramname">session</td><td>The session where the key will be used. </td></tr>
    <tr><td class="paramname">result</td><td>Must be set to the key object to used for the given session. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> if result is set, or less than zero on error. </dd></dl>

<p>Definition at line <a class="el" href="dtls_8h_source.html#l00184">184</a> of file <a class="el" href="dtls_8h_source.html">dtls.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae645f85dd55a51ca1b3fb554d1e752f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* dtls_handler_t::get_psk_info) (struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, const <a class="el" href="structsession__t.html">session_t</a> *session, <a class="el" href="dtls_8h.html#a36eda3add5e2d12a3b5e2b6fe7038e01">dtls_credentials_type_t</a> type, const unsigned char *desc, size_t desc_len, unsigned char *result, size_t result_length)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called during handshake to get information related to the psk key exchange. The type of information requested is indicated by <code>type</code> which will be one of DTLS_PSK_HINT, DTLS_PSK_IDENTITY, or DTLS_PSK_KEY. The called function must store the requested item in the buffer <code>result</code> of size <code>result_length</code>. On success, the function must return the actual number of bytes written to <code>result</code>, of a value less than zero on error. The parameter <code>desc</code> may contain additional request information (e.g. the psk_identity for which a key is requested when <code>type</code> == <code>DTLS_PSK_KEY</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The current dtls context. </td></tr>
    <tr><td class="paramname">session</td><td>The session where the key will be used. </td></tr>
    <tr><td class="paramname">type</td><td>The type of the requested information. </td></tr>
    <tr><td class="paramname">desc</td><td>Additional request information </td></tr>
    <tr><td class="paramname">desc_len</td><td>The actual length of desc. </td></tr>
    <tr><td class="paramname">result</td><td>Must be filled with the requested information. </td></tr>
    <tr><td class="paramname">result_length</td><td>Maximum size of <code>result</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes written to <code>result</code> or a value less than zero on error. </dd></dl>

<p>Definition at line <a class="el" href="dtls_8h_source.html#l00155">155</a> of file <a class="el" href="dtls_8h_source.html">dtls.h</a>.</p>

</div>
</div>
<a class="anchor" id="abafcef01c1edb023b160a5c88bf4c58f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* dtls_handler_t::read) (struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, <a class="el" href="structsession__t.html">session_t</a> *session, <a class="el" href="global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf, size_t len)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called from <a class="el" href="dtls_8c.html#ae272fea7269714fe7a67d6da64961731">dtls_handle_message()</a> deliver application data that was received on the given session. The data is delivered only after decryption and verification have succeeded.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The current DTLS context. </td></tr>
    <tr><td class="paramname">session</td><td>The session object, including the address of the data's origin. </td></tr>
    <tr><td class="paramname">buf</td><td>The received data packet. </td></tr>
    <tr><td class="paramname">len</td><td>The actual length of <code>buf</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ignored </dd></dl>

<p>Definition at line <a class="el" href="dtls_8h_source.html#l00114">114</a> of file <a class="el" href="dtls_8h_source.html">dtls.h</a>.</p>

</div>
</div>
<a class="anchor" id="a80c44baf0a59be0fd842358e651deaf4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* dtls_handler_t::verify_ecdsa_key) (struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, const <a class="el" href="structsession__t.html">session_t</a> *session, const unsigned char *other_pub_x, const unsigned char *other_pub_y, size_t key_size)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called during handshake to check the peer's pubic key in this session. If the public key matches the session and should be considerated valid the return value must be <code>0</code>. If not valid, the return value must be less than zero.</p>
<p>If ECDSA should not be supported, set this pointer to NULL.</p>
<p>Implement this if you want to verify the other peers public key. This is mandatory for a DTLS client doing based ECDSA authentication. A server implementing this will request the client to do DTLS client authentication.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The current dtls context. </td></tr>
    <tr><td class="paramname">session</td><td>The session where the key will be used. </td></tr>
    <tr><td class="paramname">other_pub_x</td><td>x component of the public key. </td></tr>
    <tr><td class="paramname">other_pub_y</td><td>y component of the public key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> if public key matches, or less than zero on error. error codes: return dtls_alert_fatal_create(DTLS_ALERT_BAD_CERTIFICATE); return dtls_alert_fatal_create(DTLS_ALERT_UNSUPPORTED_CERTIFICATE); return dtls_alert_fatal_create(DTLS_ALERT_CERTIFICATE_REVOKED); return dtls_alert_fatal_create(DTLS_ALERT_CERTIFICATE_EXPIRED); return dtls_alert_fatal_create(DTLS_ALERT_CERTIFICATE_UNKNOWN); return dtls_alert_fatal_create(DTLS_ALERT_UNKNOWN_CA); </dd></dl>

<p>Definition at line <a class="el" href="dtls_8h_source.html#l00214">214</a> of file <a class="el" href="dtls_8h_source.html">dtls.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1584dc27fdeff72bbea07a8d646f087d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* dtls_handler_t::write) (struct <a class="el" href="structdtls__context__t.html">dtls_context_t</a> *ctx, <a class="el" href="structsession__t.html">session_t</a> *session, <a class="el" href="global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf, size_t len)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called from <a class="el" href="dtls_8c.html#ae272fea7269714fe7a67d6da64961731">dtls_handle_message()</a> to send DTLS packets over the network. The callback function must use the network interface denoted by session-&gt;ifindex to send the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The current DTLS context. </td></tr>
    <tr><td class="paramname">session</td><td>The session object, including the address of the remote peer where the data shall be sent. </td></tr>
    <tr><td class="paramname">buf</td><td>The data to send. </td></tr>
    <tr><td class="paramname">len</td><td>The actual length of <code>buf</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The callback function must return the number of bytes that were sent, or a value less than zero to indicate an error. </dd></dl>

<p>Definition at line <a class="el" href="dtls_8h_source.html#l00099">99</a> of file <a class="el" href="dtls_8h_source.html">dtls.h</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="dtls_8h_source.html">dtls.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 8 2016 15:03:21 for tinydtls by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
