\section{Introduction}
The expanding IoT applications constantly proposes higher requirements to security where cryptography plays an important role. Among all issues need to be solved before implementing cryptographic primitives on IoT devices, the implementation of a reliable Random Number Generator (RNG) is critical as it is required in most cryptographic algorithms. In practice, RNG implementations usually involves sampling from a physically high entropy source.

In 2013, Texas Instruments released a new System-on-chip (SoC)  CC2538\cite{CC2538}, featuring integrity, 802.15.4 support and feasible for security applications with multiple cryptographic hardware accelerator. It was not long before it draw the community interest. For example, Contiki and OpenWSN soon published their support to CC2538 within the same year. As of writing this paper, this chip remains in the suggested list for Zigbee and 6LoWPAN solution.

To our surprise, despite all the cryptographic hardware support, the chip does not have a RNG dedicated for cryptographic applications; instead, the user manual suggested to use a 16 bit Linear Feedback Shift Register (LFSR) as a Pseudo Random Number Generator (PRNG), where the seed is sampled by the Radio Frequency (RF) module from the radio noise. It turns that this practice is not good for building cryptography on these chips as:
\begin{itemize}
	\item The PRNG has only 16 bit entropy which can be easily predicted.
	\item Sampling the seed from RF induces the potential for an adversary to interfere the seeding procedure through radio signals.
\end{itemize}

In this paper, we first revised why such PRNG designed is a bad idea, explaining how this can be exploited to completely break DTLS handshake with ECDHE\_ECDSA. Then we present a study to its method of sampling the random seed from radio noise and finally demonstrate how the seed could be biased through radio jamming. Our experiments are performed on Contiki release 3.0. The related source code can be accessed at \cite{prngtest}.

\section{Related Work}
The design flaw of using a 16 bit LFSR as PRNG has been reported by \cite{SmartMeterBlog}\cite{CC2530PRNG} on CC2430, which is one of the predecessors of CC2538. The blogs reported the flaw and warned that it could easily be exploited to break the Z-Stack library\cite{ZStack} and Smart Energy Profile ECC in many Smart Meter applications.

With respect to using jamming signal to bias the seed, this is the first work that has been done on this subject to our knowledge.

\section{Contiki Driver Issue}
As of writing this paper,  the CC2538 RNG driver in the current Contiki release version (release-3.0) has some coding issues, including:
\begin{itemize}
	\item Reading the LFSR without ready check.
	\item Lack of validity check when reading random bits from RF module.
	\item A coding mistake that drops the Most Significant Bit (MSB) and leaves the Least Significant Bit (LSB) to be constantly $0$.
\end{itemize}

We have modified the code and fixed these issues in our experiments. The issues are reported to the code authors and are expected to be fixed in the future release of Contiki.

Another issue in the driver is that the CC2538 User's Guide\cite{CC2538Manual} suggests only to use the lower byte (8 bits) as a random number but the driver actually used 16 bits in the LFSR. However, this coding mistake does not affect our result, as will be explained in  later sections.