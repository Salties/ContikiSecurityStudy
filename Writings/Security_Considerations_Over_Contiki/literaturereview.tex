\chapter{Preliminaries:\\ Literature Review} \label{Chp: LiteratureReview}

In this chapter we review the literatures with respect to security in WSN. We roughly categorise the literatures into three aspects we consider to be mostly relevant to this project:

\begin{enumerate}
	\item Protocol and implementation flaws
	\item Traffic analysis techniques
	\item Information leakage detection
\end{enumerate}

As introduced in \Cref{Chp: Building Blocks}, many 6LoWPAN protocols are derived from Internet. Therefore in this report we also refer to existing attacks on Internet that could potentially be applied in WSN.

\section{Protocol and Implementation Flaws}

%In this section we focus on protocol suite described in \Cref{Tbl: Summary of WSN Building Blocks}, namely `'802.15.4 + 6LoWPAN + CoAP''.

%Security consideration of 802.15.4
\subsection{802.15.4 PHY and MAC}
\cite{802154sec} reviews the design flaw in 802.15.4 Security. First of all, the nonce reuse may happen due to the same key used in different entry, or power failure on device. Secondly, the key management also needs to be improved. The ACL does not support group key, using a default ACL entry for network shared key is incompatible with replay protection. Finally, the Security Levels without authentication should not be used. Allowing an adversary to forge messages potentially breaches the data confidentiality in many applications. It also allows the adversary to launch a Denial of Service, DoS, attack by spoofing a frame with the maximum Frame Counter which eventually triggers the replay protection on later legitimate frames. In addition, the lack of security in ACK frames can also be exploited in a jamming DoS attack to forge false ACKs to prevent retransmission.

\subsection{6LoWPAN}
%6LoWPAN Fragmentation Attack
6LoWPAN fragmentation attack\cite{6lpFragAtk} exploits the unauthenticated packet fragments in 6LoWPAN. An adversary within the network can spoof a fragment of IPv6 packet causing the receiver to drop the corrupted  packet, or she can send a forged initial fragment requesting the victim node to allocate unnecessary memory which eventually results into legal packets being dropped. They propose two countermeasures to prevent these fragmentation attacks. The first countermeasure is to add chained integrity tag into each fragment to prevent the spoofed fragments. The second countermeasure is to use a more sophisticated memory management scheme that does not allocate memory until an actual fragment is received.

%6LoWPAN DoS
\cite{6lpRplAtk} gives an overview of attacks that targets 6LoWPAN and RPL. These attacks mainly results into malfunctioning of the WSN. In Sinkhole Attack\cite{Sinkhole}, the malicious node sends false RPL message to direct all messages to itself. Sinkhole Attack can further extend to Blockhole Attack\cite{Blackhole} by dropping all packets silently, eventually disables the communication of network. Wormhole Attack\cite{Wormhole} works by replaying legitimate RPL messages at an illegal location, causing confusion in the DODAG structure and therefore disrupts the communication. A malicious node launching Hello Flood Attack repeatedly broadcasts a Hello, refers to DIS, message, triggers its neighbour to respond with DIO messages and eventually depletes the battery of victims.

\subsection{TLS and DTLS}
\cite{rfc7457} summarises known attacks  against TLS and DTLS. Due to the constrained resources in WSN devices, implementations tend to support only  minimum protocols and cipher suites. We omit some of these attacks as they do not seem to be feasible in WSN environments.

\subsubsection{Compression Ration Attacks}

%Compression Ratio Attack
Compression Ratio Attack is proposed in \cite{CompressionRationAttack} which is a type of plaintext recovery attack that exploits the length difference of compressed ciphertext. This type of attack has been realised by the CRIME\cite{CRIME} Attack against TLS compression, and TIME\cite{TIME} Attack and BREACH\cite{BREACH} Attack against HTTP compression respectively. In this type of attacks, the plaintext constitutes of two parts. The first part is the explicit part which is known or even controlled by adversary. The second part is the implicit part which is unknown secret to the adversary . The first observation is that the plaintext is compressed before encrypted, since the encrypted ciphertext should appears random and can be hardly compressed. The second observation is that the more repetitive patterns in the plaintext the more bytes it will be compressed and hence results into more shrink in the length of ciphertext. The two factors combined together gives the adversary an oracle to guess the implicit part of plaintext through the explicit part, as a correct guess in the explicit part corresponds to a higher compression ratio in ciphertext.\cite{CompressionCountermeasure} proposed two countermeasures to this types of attacks. The first one is to compress the explicit part and implicit part separately. This approach completely disables the compression oracle but is not generally applicable as the explicit part and implicit part are application dependent. The second countermeasure is to use a fixed dictionary in compression. This countermeasure prevents such attacks since the explicit part no longer affects the compression ratio of the secret, but this method drastically degrades the performance of compression. Even though the protocol suite we introduced in \Cref{Chp: Building Blocks} does not include any of such compression\footnote{The IPv6 header compression can be considered to be using a fixed common dictionary.} methods, this attack should still be taken into account, as compressions are very likely to be used in WSN applications due to their low bandwidth nature. 

\subsubsection{Padding Oracle Attacks}

%Lucky 13
Lucky Thirteen Attack\cite{Lucky13} is a Padding Oracle Attack\cite{PaddingOracle} on DTLS. The Padding Oracle Attack targets cipher suites with padding and MAC-then-Encrypt in CBC mode of operation. Denote $C_n$ to be the last block of the $n$-blocks ciphertext. During a CBC decryption, $C_n$ is decrypted by the block cipher first and then XORed with $C_{n-1}$ resulting into the plaintext $P_n$. $P_n$ is then first checked with correct scheme padding, and then the MAC. In older version of SSL/TLS, failure at different steps returns different error messages. The padding oracle refers to such a source that distinguishes the difference between these errors. Such difference in error messages can therefore exploited by an adversary who is capable of asking the decryption of chosen ciphertexts. To be more specifically, for a target ciphertext, the adversary first modifies the second-last block of ciphertext from the first byte forward. These modifications will be directly XORed to the plaintext, triggering a MAC error until the padding is affected which triggers a padding error instead. This exposes the position of the last byte of plaintext in $C_n$. Since the padding values are predictable, the adversary then modify the byte in $C_{n-1}$ which corresponds to the last byte of plaintext in $C_n$ alongside with the bytes corresponds to the padding. The aim of this modification it to trick the decryption process to treat the modified last byte of plaintext as part of the padding. Once a MAC error is returned, which indicates the ciphertext has passed the padding check, the adversary can soon learn the last byte of plaintext by XORing the modified difference with the predicted padding value. The process can be carried on backward byte by byte to recover the full plaintext.  Later versions of SSL/TLS patched this vulnerability by using an unified error message on both check failures, but further study\cite{Lucky13} shows that such padding oracle can still be constructed by observing the slight timing difference of both errors. Specifically in the case of DTLS, although the protocol by nature does not provide the error messages, the timed padding oracle can still be constructed through observing the response time for a DTLS Heartbeat message. However, such attack is not yet feasible in our platform as the protocol suite / implementation in our platform does not employ any cipher suite with CBC mode.

%Smartgrid Dump Crypto


\section{Traffic Analysis}

Traffic Analysis is a family of attacks on Internet. Security protocols, such as SSL/TLS,  provide authenticity, integrity and confidentiality protection to the application data, but many side channel information are usually overlooked by the protocols, including headers of unencrypted protocols, timing information of packets and length of packets. 

Studies, \cite{WebSideChannel}\cite{PinpointWeb}\cite{Peekaboo} among the others, showed that these side channel information can indeed be exploited by an adversary to reveal some information that are intended to be hidden by the security protocols, such as contents in the encrypted packets or end identities of a communication. These side channel attacks using the observable features of traffic are generally called Traffic Analysis Attacks.

Comparing cryptographic attacks, Traffic Analysis are commonly different in a way such that:
\begin{itemize}
	\item Traffic Analysis does not try to break the cryptographic primitives, as we can see later in this section. 
	\item Traffic Analysis Attacks are highly application dependent. As we can see later in this section, most Traffic Analysis Attacks are targeted at a specific application, either a website, a search engine or a text message service, etc.
	\item The target usually assumes a publicly known smaller plaintext space, instead of the arbitary message in many cryptographic context. For example, one attack in \cite{WebSideChannel} targets a selection list in a website with only tens of options,  \cite{Peekaboo} discusses attacks in a closesd world, i.e. an idea world with only hundreds or thousands websites.
	\item Traffic Analysis are hard to prevent, as shown in \cite{Peekaboo} that many countermeasures proposed end up failed to prevent the attacks.
\end{itemize}

We consider Traffic Analysis to be one of the most critical security and privacy threat in WSN applications for three reasons:
\begin{enumerate}
	\item Nodes communicates to each others through RF in open environments. It is easier than Internet for adversaries to monitor the traffic.
	\item Nodes are geographically less distant. This provides the opportunity for the adversary to conduct mass surveillance like attacks.
	\item Countermeasures are difficult to implement in constrained devices due to overhead. Many countermeasures are application specific.
\end{enumerate} 

\subsection{Traffic Analysis Attacks}
\cite{WebSideChannel} describes the general idea of Traffic Analysis against web web applications. In this paper, a web application is modelled as a stateful system and the packet features being the input and output of the system. The paper introduced how these side channel information can be exploited through examples of encrypted real world websites.
\begin{example}
	The first example is a health record system as shown in \Cref{Fig: HealthRecordSystem}.
	
	\begin{figure}[h!]
		\center
		\includegraphics[width=0.7\textwidth]{fig/WebSideChannelExample1.png}
		\caption{Example Health Record System from \cite{WebSideChannel}}
		\label{Fig: HealthRecordSystem}
	\end{figure}
	
	In this example, the authors demonstrated that according to which tab or alphabet the user has clicked, the server returns a series of  packets with distinguishable lengths and directions. Further more, distinguishable packet traces can also be observed when user types in the input box triggering auto suggestion. As a result, an eavesdropper can deduce the user input simply by looking at the packet features of encrypted traffic.
\end{example}

\begin{example}
	The second vulnerable website is an online taxing service. In this system, the tax application form varies due to the payee's family status. The vulnerability of this website is that users are directed to different pages according to the form they are going to fill, while different pages results into packets of different lengths and directions, allowing an eavesdropper to reveal the family status of the user. The packet features of encrypted traffic again breached the data confidentiality.
\end{example}

%Financial charts Example
\begin{example}
	The third example is an online investment system where financial charts are provided to the users. The vulnerability is that an eavesdropper can distinguish which chart is presented to an user by the size of the chart which is a gif file. 
\end{example}

%Search Keyword Example (briefly, refers to the other one)
\begin{example}
	The last example shows how Traffic Analysis can be applied to attack the key word user provided to a search engine. \cite{SearchAttack} gives a more thorough description of this attack.
\end{example}

\cite{PinpointWeb} extends the work from a leakage detection perspective. Similar to \cite{WebSideChannel}, a web application is modelled as state machine with the user input and packet traces being the input and output respectively. The packet traces are aligned by sequence of packets. A hypothetical DETECT function is then iterated over the positions of packets. For each position, DETECT function computes an information leakage metric by the aligned packets from different traces and returns it as an indicator of potential information leakage at that position. They further instantiated the DETECT function by using Mutual Information of user input and packet features. Finally, they showed that in the experiment done on an example web application, the ACK flag could also be a potential leakage source in addition to packet sizes, where the latter is a widely exploited packet feature in many Traffic Analysis Attacks.

\cite{SearchAttack} implements the Traffic Analysis Attack on search engines described by \cite{WebSideChannel} in more details. It exploits the fact that Google by default enables auto suggestion which responds to each key stroke of user input with the suggest options and preloaded pages. This attack assumes the user input is within a finite dictionary. The attack is done in two steps:

\begin{enumerate}
	\item The first step is the profiling step. The attacker first builds a prefix tree\cite{PrefixTree} for the whole dictionary. For each edge of the prefix tree, which corresponds to a key stroke from parent to child, the attacker associates it with the distribution of server responded packet sizes that is gathered through multiple trials. 
	\item When an user's traffic is captured, the attacker compares the server responses for each user key stroke to the edges in the prefix tree from the root to the leafs. For each comparison, the attacker computes a likelihood and accumulates it through stochastic algorithms. 
\end{enumerate}

Finally, the algorithms outputs a set of keyword guesses of the highest likelihoods. The attack is considered successful if the keyword user typed appears in the guesses. At the end of the paper they showed that their method proofed to be effective in their settings.

%Web site fingerprinting
Another well studied topic in Traffic Analysis Attack is Website Fingerprint. \cite{WebsiteFingerprint} demonstrates the application scenario as in \Cref{Fig: Application Scenario of Website Fingerprint}. 

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{fig/WebsiteFingerprint.png}
	\caption{Application Scenario of Website Fingerprint by \cite{WebsiteFingerprint}}
	\label{Fig: Application Scenario of Website Fingerprint}
\end{figure}

The goal of Website Fingerprint is to identify the website an user is visiting through a secured channel by looking at the traffic features. Its motivation has received a growth in awareness in the cyber security community due to the recent years disputable governmental mass surveillance.

\cite{WebsiteFingerprint} demonstrates the use of machine learning techniques on packet sizes. To be more specifically, the authors conducted a series of experiment in a ``closed world'' setup of 2000 websites, i.e. assuming the user visits only one of 2000 known websites. To fingerprint a website, the attacker first visits the websites gathering the packet traces. These traces are then used as the training set and fed to the classifier. When a user's traffic is captured, the trace is then treated as the test set to predict which website the user has visited. Two classifier are tested in the experiments, namely Jaccard's coefficient and naive Bayes classifier. The results show that Jaccard's coefficient outperformed naive Bayes classifier in most cases. In addition, the authors also measure the affection of time elapsed and argued that these attacks still hold after 4 weeks of profiling. However, considering the fact that the nature of Internet has changed dramatically in the past decade, the last argument might need to be reconsidered.

%Peekaboo

%Others
%Apple iMessage
%SSH attack
%VoIP attack
%Skype Video

\subsection{Traffic Analysis Countermeasures}




\section{Methodologies in Information Leakage }

