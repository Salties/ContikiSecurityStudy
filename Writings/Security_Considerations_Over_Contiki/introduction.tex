\chapter{Introduction}
Contiki OS is an embedded system that used to build WSN\footnote{Wireless Sensor Network} based on 802.15.4\cite{802154} compatible devices and 6LowPAN\cite{rfc4944}. This paper discusses two security measurements, namely Link Layer Security (LLSEC) and Datagram TLS (DTLS), within Contiki OS. We also discuss some potential methods of fingerprinting an application running on a sensor node.

In \Cref{Chp: LLSEC} we describes a LLSEC implementation in Contiki OS called \textit{noncoresec} and argues that it does not met certain cryptographic security notions.

\Cref{Chp: DTLS} discusses some implementation issues of DTLS on Contiki OS.

\Cref{Chp: Appdetect} first argues that under some natures of WSN, an adversary could possibly collect more accurate timing information than usual Internet Web-application attacker. Then we describe a potential side-channel attack that fingerprints an application the target sensor node is running, using interactions between PING protocol and the application running on the target node.

\section{Related Work}
\cite{802154Sec} discusses some security concerns in 802.15.4.  LLSEC\cite{LLSEC} is the implementation of 802.15.4 security in Contiki.

tinydtls\cite{tinydtls} is the implementation of DTLS we used in DTLS related experiments.

To our knowledge, this is the first work of application fingerprinting through traffic analysis over wireless sensor network.

\section{Experiment Setup}
All experiments are done within the Cooja simulator. The environment we simulated is as described in \Cref{fig: Setup}.

\begin{figure}
\centering
{
	\includegraphics[width=0.7\textwidth,]{fig/setup.png}
}
\caption{Experiment setup} \label{fig: Setup}
\end{figure}

\begin{itemize}
\item{\bf Adversary} is a malicious party that tries to illegally reveal information from the encrypted traffic.
\item{\bf Border Router}, or BR, is a device that connects adversary to the sensor network. \textbf{BR is not allowed when LLSEC is enabled} as the adversary does not have the key and hence cannot connect into the network. We will discuss more about LLSEC in \Cref{Chp: LLSEC}.
\item{\bf Sniffer} passively captures all traffic in the network. 
\item{\bf Target} and {\bf Nodes} are sensors deployed in the sensor network. They communicates to each other through encrypted channels.
\item{\bf Sensor Network} discussed in this paper is a 6LowPAN network based on Contiki OS.
\end{itemize}

Realistically speaking, this scenario could happen say an adversary sitting near a smart house with a laptop attached to a SoC\footnote{System on Chip} device, or your malicious neighbour walks into your smart house with her smart phone.

\section{Adversary Power}
The powers assumed in the experiments are considered to be practical in real life.

When LLSEC is enabled, all traffic, including RPL\footnote{Routing Procol for Low-power and Lossy Networks} messages, are encrypted; therefore no external nodes can connect to the network as an external node cannot send any valid RPL messages to join the network. The adversary only passively sniffs all traffic.

With LLSEC disabled, the adversary can therefore join the sensor network through a BR and hence is also capable to send messages to the target(s). However, she will not be able to inject any message into an encrypted channel such as a DTLS channel.

\section{Types of Packets}
We simply categorise the packets into two types:
\begin{itemize}
\item {\bf Network Management Packets}: These are the packets generated by the protocols to  maintain the functionality of network, such as MAC ACKs, RPL messages or ICMP messages.
\item {\bf Data Packets}: These are those packets generated by applications running on sensor nodes., such as a CoAP packet.
\end{itemize}

This is only a subjective rough categorisation and may not be precise. For example an TCP data packet may set its ACK flag, or DTLS handshake packets could ambiguously fall into both categories. However, we ignore this ambiguity as it is not our focus.