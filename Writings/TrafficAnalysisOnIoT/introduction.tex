\section{Introduction}
Traffic Analysis (TA) is a well studied technique that breaches data confidentiality over Internet, typically targeting protocols including HTTPS\cite{rfc2818} and SSL\cite{rfc6101}/TLS\cite{rfc5246}. This type of attacks works by correlating the encrypted contents to side channel information frequently omitted by cryptographic scheme designs, such as packet length, timing and any other unprotected meta data. Consequently, TA is often associated to Internet privacy violation and Mass Surveillance.

The extensive use of radio communication in exposed environment poses a great security challenge to IoT applications, especially against TA attacks as packets containing critical privacy data, e.g. driving information in Vehicular Ad Hoc Networks(VANETs)\cite{VANET} and daily life data in a smart house, can be easily eavesdropped and analysed by adversaries.

In this paper, we discuss the applicability of TA techniques over IoT application traffic. To be more specifically, we present an attempt of TA attacks on a 6LoWPAN\cite{rfc4944} network powered by Contiki\cite{Contiki} and demonstrate the potential of extracting ``supposedly'' private information from. Although revealing these information does not directly imply any security problem in the setup due to the fact that they are purely designed for experimental purposes, but the result indicates that TA attacks should be concerned when designing secure IoT applications.

%Finally the paper structure
\textbf{[TO BE CONTINUE...]}

\subsection{Related Work}
%Literatures about Traffic Analysis...
%Literatures about 6LoWPAN security
\textbf{[TO BE CONTINUE...]}

\subsection{Noncoresec}
%Noncoresec
Noncoresec\cite{noncoresec} is the implemented Link Layer\cite{OSI} security in the latest Contiki release (3.0). Noncoresec is a 802.15.4 Security\cite{802154} implementation using hardcoded network key. Due to the absence of IPSec\cite{rfc4301}, noncoresec is effectively the only applicable approach for securing the network metadata, including IP headers and TCP/UDP headers.

%Platform
Most of our studies are done on traffic data generated by Cooja simulator\cite{Contiki}. However, TelosB\cite{TelosB} and CC2538\cite{CC2538} are also used to gather performance critical data, such as timings.

\subsubsection{Implementation Issues}
%Reset Attack and Anti-Replay
Although not directly linked to the subject of this paper, we realised two issues exist in the noncoresec implementation:
\begin{itemize}
	\item \textbf{Nonce Reuse} \\
	According to the 802.15.4 specification\cite{802154}, for packets sent from a specific MAC address, Frame Counter (shown in \Cref{NoncoresecNonce}) is the only variable field in the nonce construction. Noncoresec implemented Frame Counter as a static variable; therefore it is initialised to 0 upon each reboot. Such implementation would allow an adversary to force nonce reuse by resetting the device which in many cases can lead to full breach of the plaintext.
	
	\begin{figure}[th!]
	\centering
	\resizebox{\textwidth}{!}
	{
		\begin{tabular}{|c|c|c|c|c|}
			\hline 
			1 (bytes) & 8              & 4             & 1              & 2             \\ \hline
			Flags      & Source Address & Frame Counter & Security Level & Block Counter \\ \hline
		\end{tabular}
	}
	\caption{Noncoresec nonce construction}
	\label{NoncoresecNonce}
	\end{figure}
	
	\item \textbf{Anti-replay} \\
	Even though the incompatibility between Anti-replay and network key has been pointed out by \cite{802154SecIssues}, the noncoresec implementation has mitigated the issue by using an extra data structure recording the last Frame Counter from each source address. However, this approach also induces a problem that packets sent by a rebooted device will be labelled as replays and thus ignored.
\end{itemize}

Nonce reusing could be mitigated by initialise Frame Counter to a random value on each reboot or record its latest value on a non loss media such as flash memories, but the 4 bytes space of Frame Counter can hardly be considered cryptographically secure. Therefore a full solution may not be achieved without updating the nonce construction specified by the standard\cite{802154}. The anti-replay issue is closely related to the key management which remains an open question in many IoT applications; hence it would be difficult derive a general solution. Our recommendation is to simply disable the anti-replay feature in noncoresec and leave it to upper layer protocols and/or applications.