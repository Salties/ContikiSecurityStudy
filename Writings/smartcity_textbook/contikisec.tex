\chapter{Contiki OS}
Assuming this is the structure...

\section{Security in Contiki OS}

%Though these paragraphs might not be necessary...
%The Contiki OS has some component implemented in the security aspect. Several factors need to be taken into account when selecting security components to be used in the application, including:
%
%\begin{itemize}
%\item The trade-off between security and performance, such as the overhead of bandwidth, energy consumption, etc. Usually a higher level of security comes with more reduction in performance.
%
%\item The capability of the potential adversary. For example, passive eavesdropping is a common type of attack in a Wireless Sensor Networks scenario. Further more, if the device is exposed in an open environment then side channel attacks\footnote{Attacks that exploit physical metadata, e.g. power consumption, timing information, etc.} need also be taken into consideration. In some cases legitimate users can also considered malicious,  say users who try to tamper with their smart meter readings.
%
%\item The hardware and software setup of the platform. For instance, the AES coprocessor provided in CC2538 platform provides a great performance in both computation time and energy consumption; the latency induced by ContikiMAC can make attacks exploit the packet timing information more difficult.
%\end{itemize}
%
%After all, due to the constrained resources and variant applications, implementing security protocols poses great difficulties in Contiki OS as well as other embedded operating systems.
%
%In this section, we will cover two major security component that has been implemented on Contiki OS, Link Layer Security and DTLS.

Implementing security protocols poses great difficulty in IoT devises due to the constrained resources and variant applications. In this section, we will cover two security components that has so far been implemented in Contiki OS, namely LLSEC and DTLS respectively.

\subsection{LLSEC: noncoresec}
Link Layer Security, or LLSEC, is to provide security mechanism at Link Layer level. In Contiki OS, noncoresec is the 802.15.4 security instantiation that has been implemented. Its design goal is to provide:
\begin{itemize}
\item Data confidentiality over MAC layer payload.
\item Authenticity and integrity over MAC header and MAC payload.
\end{itemize}

noncoresec is disabled by default. When enabled, different security level can be configured from no security, to encryption / authentication only, then to full encryption and authentication.

To be more specifically, noncoresec has the following implemented:

\begin{description}
\item[\textbf{Block Cipher}] \hfill \\
As specified by 802.15.4 specification, AES-128 is chosen as the underlying block cipher. Contiki OS implements a software AES, but on those platforms with an AES coprocessor, such as CC2538, it can be switched to use the hardware implementation instead. The benefit for doing so is to have a better time and energy efficiency as well as to gain potential protections against side channel analysis attacks.

\item[\textbf{Mode of Operation}] \hfill \\
Also specified by 802.15.4 specification, the AES block cipher is used in CCM* mode, i.e. CTR mode with CBC-MAC. The asterisk symbol implies the additional support of security levels and additional requirement to encode the security level into the nonce.

\item[\textbf{Key Management}] \hfill \\
 A hard coded 128 bit AES key is shared among the whole network in LLSEC. This effectively means that the same key will be used for all incoming and outgoing data frames on every node.
 
\item[\textbf{Replay Protection}] \hfill \\
noncoresec has implemented the replay protection by comparing the received frame counter with the last frame counter from the same source.
\end{description}

Therefore in general, noncoresec has the following benefits:
\begin{itemize}
\item It prevents an eavesdropper from seeing the plaintext of MAC Layer payload.
\item It prevents illegal nodes from joining the network, as nodes without knowledge of the network shared key cannot forge a message.
\item It can be implemented efficiently on most platforms, especially with hardware support.
\end{itemize}

However, the following factors should also be taken into concern when adopting noncoresec as the security measures:
\begin{itemize}
\item Lack of flexibility. This is mostly due to the fact that the key is hard coded.
\item Fixed key. As there is yet no key updating scheme implemented.
\item Reused nonce. Since in CCM mode, the difference of two ciphertext is exactly the same of their according plaintext and knowing that can lead to breach of data confidentiality in many cases. The reuse may occur when the 4 bytes frame counter rounds up, or when the devices reboots which resets the frame counter back to $0$.
\item 
\end{itemize}

More discussion with regard to 802.15.4 security can be found in \cite{802154sec}.

\subsection{DTLS}




\begin{thebibliography}{99.}
\bibitem{802154sec} Sastry N, Wagner D (2004) Security Considerations for IEEE 802.15.4 Networks. Proceedings of the 3rd ACM Workshop on Wireless Security 32--42
\end{thebibliography}
